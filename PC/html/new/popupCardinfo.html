<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Script-Type" content="text/javascript">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=950">
<title>HOTTRACKS - 생활 속 감성충전소</title>

    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/earlyaccess/notosanskr.css">
    <link href="../../images/biz/common/favicon.ico" rel="shortcut icon">
    <link rel="stylesheet" type="text/css" href="../../css/common.css">
    <link rel="stylesheet" type="text/css" href="../../css/layout.css">
    <link rel="stylesheet" type="text/css" href="../../css/contents.css">
    <link rel="stylesheet" type="text/css" href="../../css/biz/common_v2.css">
    <link rel="stylesheet" type="text/css" href="../../css/biz/hottweb_yj.css">
    <link rel="stylesheet" type="text/css" href="../../css/biz/slick.css">

    <link rel="stylesheet" type="text/css" href="../../pages/html/css/shop.css">
    <link rel="stylesheet" type="text/css" href="../../css/new/orderandpay.css">


<script type="text/javascript" src="../../js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="../../scripts/common.js"></script>
<script type="text/javascript">

var url ='';
var cart_yn = "";
var height = 1050;
var width  = 400;
$(document).ready(function() {
    window.resizeTo(500+35,350+65);

    if(cart_yn=="Y"){
        url = "/issue/CardIssueCart.do";
    }else{
        url = "/issue/CardIssue.do";
    }
    url+= "?TID=" + "kyobohot1m01012011131237267526" + "&svcCd="+""+"&sendMail="+"1" + "&cart_yn="+""+"&svc_cl="+"";
    if("N" == "Y"){
       window.resizeable = true;
       window.resizeTo(width+35,height+65); //여백
       window.location.href = url;
    }
    else{
        document.getElementById("mainDiv").style.display = "block";
    }
})
   
   function nextchk(num,here,next){
      var str = here.value.length;
      if(str == num ){
         next.focus();
      }
   }
   
   function onClickRadioBtn(flag)
   {
       if(flag == "amt") {
           document.getElementById("trAmt1").style.display = 'block';
           document.getElementById("trAmt2").style.display = 'block';
           document.getElementById("trEmail").style.display = 'none';
           document.getElementById("trCardno").style.display = 'none';
       } else if(flag == "email") {
           document.getElementById("trAmt1").style.display = 'none';
           document.getElementById("trAmt2").style.display = 'none';
           document.getElementById("trEmail").style.display = 'block';
           document.getElementById("trCardno").style.display = 'none';
       } else if(flag == "cardno") {
           document.getElementById("trAmt1").style.display = 'none';
           document.getElementById("trAmt2").style.display = 'none';
           document.getElementById("trEmail").style.display = 'none';
           document.getElementById("trCardno").style.display = 'block';
       }
   }
   function getOnlyDigit( number )
   {
    if(number == undefined){
        number = "0";
    }
    
    var i;
    var result = "";

    for(i=0; i<number.length; i++)
    {
        if( number.charAt(i)>='0' && number.charAt(i)<='9' )
            result += number.charAt(i);
    }

    return result;
   }
   
   /* 천단위 콤마 표시 */
   function numberMaskOn(myForm)
   {                
    var reverseMaskedNumber = "", maskedNumber = "";
    var integerCount = 0, maskCount = 0, isPoint = 0;
    var integerIndex ;
    var tmpValue;

    myForm.value = getOnlyDigit(myForm.value);
    
    integerIndex = myForm.value.length;
    
    for (i = myForm.value.length - 1 ; i >= 0 ; i--)
    {
        reverseMaskedNumber += myForm.value.charAt(i);
        if (myForm.value.charAt(i) == ".")                          
        {
            integerIndex = i - 1;
            isPoint = 1;
            break;
        }
    }

    if (isPoint == 0)
    {
        reverseMaskedNumber = "";
        integerIndex -= 1;
    }
    
    for ( i = integerIndex ; i >= 0 ; i--)
    {
        integerCount++;
        reverseMaskedNumber += myForm.value.charAt(i);
        if (integerCount % 3 == 0 && i != 0 && myForm.value.charAt(i-1) != "-")
        {
            reverseMaskedNumber += ",";
            maskCount++;
        }
    }

    for ( i = maskCount + myForm.value.length ; i >= 0 ; i--)
    {
        maskedNumber += reverseMaskedNumber.charAt(i);
    }

    myForm.value = maskedNumber;
   }
   function showCardIssue() {
       var f = document.form;
       var typeArr = document.getElementsByName("selType");
       var typeCd = "";
       
       for(var i = 0; i < typeArr.length; i++) {
           if(typeArr[i].checked) {
               typeCd = typeArr[i].value;
               if(typeCd == "0"){ //구매자명 + 금액
                   if(f.ordNm.value == ""){
                       alert("구매자명을 입력하세요.");
                       f.ordNm.focus();
                       return;
                   }
                   if(f.appAmt.value == ""){
                       alert("결제금액을 입력하세요.");
                       f.appAmt.focus();
                       return;
                   }
               }else if(typeCd == "1"){ //이메일
                   if(f.email.value == ""){
                       alert("이메일을 입력하세요.");
                       f.ordNm.focus();
                       return;
                   }
               }else if(typeCd == "2"){ //카드번호
                   if(f.card1.value.length != 4 || f.card2.value.length != 4 || f.card3.value.length != 4 || f.card4.value.length < 3){
                       alert("카드번호를 입력하세요.");
                       if(f.card1.value.length != 4){
                           f.card1.focus();
                           return;
                       } 
                       if(f.card2.value.length != 4){
                           f.card2.focus();
                           return;
                       }
                       if(f.card3.value.length != 4){
                           f.card3.focus();
                           return;
                       }
                   }
               }
           }
       }
       
       $.ajax({
           type : "POST",      
           url : "./CheckCardInfoAjax.do",
           data : { "tid" : "kyobohot1m01012011131237267526",
                    "typeCd" : typeCd,
                    "ordNm" : f.ordNm.value,
                    "appAmt" : f.appAmt.value.split(",").join(""),
                    "ordEmail" : f.email.value,
                    "cardNo" : f.card1.value+f.card2.value+f.card3.value+f.card4.value
                  },
           contentType : "application/json",
           dataType : 'json', 
           success : function(data){
               if(data.cnt != "0"){
                   window.resizeTo(width+10,height+65); //여백
                   window.location.href = url;
               }else{
                   alert("입력하신 정보와 일치하지않습니다.");
               }
           }
       });
   }
   

</script>

</head>
<!-- 201222 S : 작업부분 body에 class="orderandpay" 넣어주세요  -->
<body class="popup orderandpay ">
    <div>
        <div class="tooltip_wrap active">
            <div class="tooltip_inner">  
                <p class="tooltip_tit">전표출력 확인</p>

                <div class="pop_cont">
                   <form id = "mainform" name="form">
                        <p class="cardinfo_alert_text">
                            영수증 확인을 위해 아래의 정보를 정확히 입력해 주시기 바랍니다.
                        </p>
                        <div id="mainDiv" style="display:none">
                            <div class="cardinfopop_wrap mgt40">
                                <div>
                                    <div class="choice_wrap">
                                        <div class="choice_wrap_inner">
                                            <input type="radio" name="selType" value="0" onClick="javascript:onClickRadioBtn('amt');" id="cashReceipt11" checked="">
                                            <label for="cashReceipt11">구매자명 + 금액 </label>
                                        </div>
                                        <div class="choice_wrap_inner">
                                            <input type="radio"  name="selType" value="1"  onClick="javascript:onClickRadioBtn('email');" id="cashReceipt12" value="N">
                                            <label for="cashReceipt12">이메일</label>
                                        </div>
                                        <div class="choice_wrap_inner">
                                            <input type="radio"  name="selType" value="2"  onClick="javascript:onClickRadioBtn('cardno');" id="cashReceipt13" value="N">
                                            <label for="cashReceipt13">카드번호</label>
                                        </div>
                                    </div>

                                    <div class="mgt20 choice_layer_wrap">
                                        <div class="" id="trAmt1">
                                            <dl class="cardinfo_choice_list">
                                                <dt class="cardinfo_title">구매자명</dt>
                                                <dd class="cardinfo_desc">
                                                    <div class="input_wrap">
                                                        <input type="text" placeholder="" name="ordNm"  class="width_cs">
                                                    </div>
                                                </dd>
                                            </dl>                                        
                                        </div>
                                        <div class=""  id="trAmt2">                                            
                                            <dl class="cardinfo_choice_list mgt15">
                                                <dt class="cardinfo_title">결제금액</dt>
                                                <dd class="cardinfo_desc">
                                                    <span class="input_wrap">
                                                        <input type='text' name="appAmt" class="width_cs" maxlength='12' onkeyup="javascript:numberMaskOn(this);">
                                                    </span>
                                                    <span class="unit_price">원</span>
                                                </dd>
                                            </dl>    
                                        </div>
                                        <div class="" id="trEmail" style="display:none">                                           
                                            <dl class="cardinfo_choice_list">
                                                <dt class="cardinfo_title">이메일</dt>
                                                <dd class="cardinfo_desc">
                                                    <div class="input_wrap">
                                                        <input type="text" placeholder="" name="email" class="width_cs">
                                                    </div>
                                                </dd>
                                            </dl>
                                        </div>
                                        <div class="" id="trCardno" style="display:none">                                         
                                            <dl class="cardinfo_choice_list">
                                                <dt class="cardinfo_title">카드번호</dt>
                                                <dd class="cardinfo_desc">
                                                    <div class="choice_wrap type_squre have_inner_txt inner_float">
                                                        <div class="input_wrap">
                                                            <input name="card1" type="text" size="4" maxlength="4"  onKeyUp="javascript:nextchk(4,this,this.form.card2);"/>
                                                        </div>
                                                        <div class="input_wrap">
                                                            <input name="card2" type="password" size="4" maxlength="4" onKeyUp="javascript:nextchk(4,this,this.form.card3);"/>
                                                        </div>
                                                        <div class="input_wrap">
                                                            <input name="card3" type="password" size="4"  maxlength="4" onKeyUp="javascript:nextchk(4,this,this.form.card4);"/>
                                                        </div>
                                                        <div class="input_wrap">
                                                            <input name="card4" type="text" size="4" maxlength="4"/>
                                                        </div>
                                                    </div>
                                                </dd>
                                            </dl>
                                            <!-- <input name="card1" type="text" size="4" maxlength="4"  style="width: 40px;height: 25px;"onKeyUp="javascript:nextchk(4,this,this.form.card2);"/>
                                             &nbsp; - &nbsp;
                                            <input name="card2" type="password" size="4" maxlength="4"style="width: 40px;height: 25px;" onKeyUp="javascript:nextchk(4,this,this.form.card3);"/>
                                             &nbsp; - &nbsp;
                                            <input name="card3" type="password" size="4"  maxlength="4"style="width: 40px;height: 25px;" onKeyUp="javascript:nextchk(4,this,this.form.card4);"/>
                                             &nbsp; - &nbsp;
                                            <input name="card4" type="text" size="4"style="width: 40px;height: 25px;" maxlength="4"/> -->
                                        </div>
                                    </div>
                                </div>
                                <a class="btn_type03 type1 mgt40" href="javascript:showCardIssue();">확인</a>
                            </div>
                        </div>
                    </form>
                    <p class="cardinfo_alert_text mgt40">[참고사항]</p>
                    <p class="cardinfo_alert_text">구매자명과 금액은 결제결과 안내 메일에 기재된 내역 기준으로 입력하시기 바랍니다.</p>
                </div> 
            </div>
            <a href="javascript:;" class="tooltip_close">닫기</a>
        </div>
    </div>
    



</body>
<!--// 201222 E : 작업부분
</html>