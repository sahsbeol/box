<%@page contentType="text/html;charset=utf-8" language="java" pageEncoding="UTF-8"%>
<!-- 태그 라이브러리 -->
<%@ include file="/pages/decorators/biz/tagHeader.jsp" %>
<html>
<head>
<script type="text/javascript">
$(document).ready(function(){
	gnb();//gnb
	nav();//nav
	if($('.header_wrap').length >0){
		bodyScroll();//body scroll
	}
	$('#content').addClass('agit');
	agitFn();
});

// 유투브 팝업
function youtubePopup(el, youtubeUrl) {
	/* 유튜브 */
	function playerVars(src,option){
		var def = {
			'autoplay' : 1,
			'control' : 1,
			'loop' : 0,
			'rel' : 0,
			'modestbranding' : 0,
		};
		if(option) $.extend(def,option);
		var s = '';
		$.each(def,function(p,v){
			s = s+p+'='+v+'&';
		});

		console.log(src+'?'+s.replace(/&$/gi,''));
		return src = src+'?'+s.replace(/&$/gi,'');
	}
	
	function setSrc($id,option){
		var src = youtubeUrl;
		//var src = 'https://www.youtube.com/embed/'+ $id.data('id'); 개발 시 변경
		$('.video_yt').attr('src',playerVars(src,option));
	}	
	
	/* 레이어팝업 */
    var winH = window.innerHeight;
    var body = $('body');
    var popup = $('.layer_popup');
    var popup_close = $('.layer_close');

    function showLayerPopup(el) {
        var $el = $(el),
            $inner = $el.find('.inner_layer');
        // console.log(winH);

        body.css('overflow', 'hidden').bind('touchmove', function (e) {
            e.preventDefault()
        });
        $el.show();
        popup.append("<div id='dim'></div>");

        if ($inner.outerHeight() < winH) {
            $inner.css('margin-top', '-' + $inner.outerHeight() / 2 + 'px');
        } else {
            $inner.css('top', '0px');
            body.unbind('touchmove');
            $('body').css('position', 'fixed');
        }

        $(window).resize(function () {
            winH = window.innerHeight;
            if ($inner.outerHeight() < winH) {
                $inner.removeAttr('style');
                $inner.css('margin-top', '-' + $inner.outerHeight() / 2 + 'px');
            } else {
                $inner.removeAttr('style');
                $inner.css('top', '0px');
                body.unbind('touchmove');
                $('body').css('position', 'fixed')
            }
        });

		setSrc($(this)); //유튜브
    }

    popup_close.on({
        click: function (e) {
            e.preventDefault();
            var $popup = $(this).closest(popup);

            $popup.hide();
            $popup.find('.inner_layer').css('margin-top', '0');
            $('body').removeAttr('style');
            body.unbind('touchmove');
            popup.find("#dim").remove();

			$('.video_yt').attr('src','');
        }
    });

    showLayerPopup(el);
}

</script>
</head>
	<body>
		<div class="agit_tit">
			<h3><span>아지트</span></h3>
		</div>
		<div class="agit_top">
			<c:forEach items="${agitList}" var="agit" begin="0" end="0">
				<div class="cont_left">
					<div class="thum">
						<a href="javascript:youtubePopup('.popup_video', '${agit.youtubeUrl}');">
							<ui:image src="${agit.imageUrl}" alt="${agit.imageAlt}"/>
						</a>
					</div>
					<div class="cont">
						<c:choose>
							<c:when test="${agit.agitTypeCd eq 'C1511'}">
								<span class="flag flag01">핫트연구소</span>
							</c:when>
							<c:when test="${agit.agitTypeCd eq 'C1512'}">
								<span class="flag flag02">핫트인</span>
							</c:when>
							<c:when test="${agit.agitTypeCd eq 'C1513'}">
								<span class="flag flag03">보이는 이야기</span>
							</c:when>
							<c:otherwise>
								<span class="flag flag04">핫트뿅뿅</span>
							</c:otherwise>
						</c:choose>
						<a href="javascript:;">
							<p class="tit">${agit.mainText}</p>
							<p class="txt">${agit.subText}</p>
						</a>
					</div>
				</div>
			</c:forEach>
			
			<c:forEach items="${agitList}" var="agit" begin="1" end="1">
				<div class="cont_right">
					<div class="thum">
						<a href="javascript:youtubePopup('.popup_video', '${agit.youtubeUrl}');">
							<ui:image src="${agit.imageUrl}" alt="${agit.imageAlt}"/>
						</a>
					</div>
					<div class="cont">
						<c:choose>
							<c:when test="${agit.agitTypeCd eq 'C1511'}">
								<span class="flag flag01">핫트연구소</span>
							</c:when>
							<c:when test="${agit.agitTypeCd eq 'C1512'}">
								<span class="flag flag02">핫트인</span>
							</c:when>
							<c:when test="${agit.agitTypeCd eq 'C1513'}">
								<span class="flag flag03">보이는 이야기</span>
							</c:when>
							<c:otherwise>
								<span class="flag flag04">핫트뿅뿅</span>
							</c:otherwise>
						</c:choose>
						<a href="javascript:;">
							<p class="tit">${agit.mainText}</p>
							<p class="txt">${agit.subText}</p>
						</a>
					</div>
				</div>
			</c:forEach>
		</div>
		<div class="cont01">
			<div class="inner">
				<ul>
					<c:forEach items="${agitList}" var="agit" begin="2" end="7">
						<li>
							<a href="javascript:youtubePopup('.popup_video', '${agit.youtubeUrl}');">
								<div class="thum">
									<ui:image src="${agit.imageUrl}" alt="${agit.imageAlt}"/>
								</div>
								<div class="cont">
									<p class="tit">${agit.mainText}</p>
								</div>
							</a>
						</li>
					</c:forEach>
				</ul>
			</div>
		</div>
		<div class="cont02">
			<div class="inner">
				<ul>
					<c:forEach items="${agitList}" var="agit" begin="8" end="20">
						<li>
							<a href="javascript:youtubePopup('.popup_video', '${agit.youtubeUrl}');">
								<div class="thum">
									<ui:image src="${agit.imageUrl}" alt="${agit.imageAlt}"/>
								</div>
							</a>
							<a href="javascript:;">
								<div class="cont">
									<c:choose>
										<c:when test="${agit.agitTypeCd eq 'C1511'}">
											<span class="flag">핫트연구소</span>
										</c:when>
										<c:when test="${agit.agitTypeCd eq 'C1512'}">
											<span class="flag">핫트인</span>
										</c:when>
										<c:when test="${agit.agitTypeCd eq 'C1513'}">
											<span class="flag">보이는 이야기</span>
										</c:when>
										<c:otherwise>
											<span class="flag">핫트뿅뿅</span>
										</c:otherwise>
									</c:choose>
									<p class="tit">${agit.mainText}</p>
									<p class="txt">${agit.subText}</p>
								</div>
							</a>
						</li>
					</c:forEach>
				</ul>
			</div>
		</div>
		<div class="cont03">
			<div class="tit">
				<h5>소소클래스</h5>
				<p>핫트랙스 감성 충전소에 초대합니다</p>
			</div>
			<div class="agit_slide_wrap">
				<div class="agit_slide">
					<ul>
						<c:forEach items="${sosoList}" var="soso">
							<li>
								<a href="/ht/biz/eventDetail?eventId=${soso.eventId}">
									<jsp:useBean id="now" class="java.util.Date" />
									<fmt:formatDate value="${now}" pattern="yyyyMMdd" var="today"/>
									<fmt:parseDate var="startDt" value="${soso.startDt}" pattern="yyyyMMdd"/>
									<fmt:parseDate var="endDt" value="${soso.endDt}" pattern="yyyyMMdd"/>
									
									<c:if test="${startDt <= today and endDt >= today}">
										<span class="badge">
											무료!클래스,접수중
										</span>
									</c:if>
									
									<div class="thum">
										<img src="/images/biz/thums/img_agit08.png" alt="">
									</div>
									<div class="cont">
										<strong>${soso.eventTitle}</strong>
										<p>${soso.eventDtlCont}</p>
										<span class="date font_t">											
											<fmt:formatDate value="${startDt}" pattern="yyyy.MM.dd"/> ~										
											<fmt:formatDate value="${endDt}" pattern="yyyy.MM.dd" />
										</span>
									</div>
								</a>
							</li>
						</c:forEach>
					</ul>
				</div>
			</div>
		</div>
		<div class="cont04">
			<h5>만족도<br/>솔직 생생후기!</h5>
			<ul>
				<!-- LightWidget WIDGET -->
				<script src="https://cdn.lightwidget.com/widgets/lightwidget.js"></script>
				<iframe src="//lightwidget.com/widgets/54fef48819be5900856d62324f4c22fe.html" scrolling="no" allowtransparency="true" class="lightwidget-widget" style="width:100%;border:0;overflow:hidden;"></iframe>
			</ul>
		</div>

		<div class="cont05">
			<a href="http://naver.me/FmpaCVTO"><img src="/images/biz/sub/img_agit.png" alt="" />
			</a>
		</div>
		
		<div class="layer_popup popup_video">
	    <div class="inner_layer" style="width:932px; height:524px;">
	        <div class="cont">
				<!-- TODO 초기화 -->
				<iframe class="video_yt" width="900" height="506" src="" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
	        </div>
    		<a href="javascript:;" class="layer_close"><span>닫기</span></a>
	    </div>
	</div>
	</body>
</html>