<%@page contentType="text/html;charset=utf-8" language="java" pageEncoding="UTF-8"%>
<!-- 태그 라이브러리 -->
<%@ include file="/pages/decorators/biz/tagHeader.jsp" %>
<html>
<head>
<script type="text/javascript">
$(document).ready(function(){
	$("#content").attr("class", "prdouct");
	gnb();//gnb
	nav();//nav
	lifeSlider();//slide
	lifeLikeInit();//like	
	if($('.header_wrap').length >0){
		bodyScroll();//body scroll
	}	
	
	// 정렬순서 변경
	$('.life_filter  li').click(function(){
		$('.life_filter li').removeClass("active");
		$(this).addClass("active");
		
		getLifeMain();		
	});
	
	// 나의 공감 클릭 시
	$('.btn_sympathy').click(function(){		
	    <c:if test='${!isLogin}'>
        	needLogin();
    	</c:if>
    	<c:if test='${isLogin}'>
	    	$(this).toggleClass('active');
			getLifeMain();
    	</c:if>		
	});
});

function getLifeMain(){
	
	var productOrderBy = $('.life_filter .active').attr("value");
	var likeYn = "";
	
	if("P" != productOrderBy && "R" != productOrderBy){
		productOrderBy = "";
	}
	
	if($('.btn_sympathy').hasClass('active')){
		likeYn = "Y";
	}else{
		likeYn = "N";
	}
	
	location.href="?productOrderBy="+productOrderBy+"&likeYn="+likeYn;
}

function lifeLikeInit(){
	
	var d = new Date();
    var url = "/images/biz/sub/heart_on.gif?a="+d.getTime();
    
    $(".heart.on").css({"background":""});	   
    $(".heart.on").css({background:"url("+url+") 50% 0% no-repeat",backgroundSize: 39});
}
</script>
</head>
<body>
	<div class="life_wrapper">
		<div class="box_life">
			<div class="tit_life">
				<h2>이럴 때,<span class='bar'></span></h2>
				<p>지극히 개인적이지만 또 누구나 공감할 수 있는 진짜 감성!<br> 바로 ‘기분’이 아닐까요?!<br> 우리는 그런 감정을 이야기하고 싶었습니다.</p>
				<div class="life_filter">
					<ul class='clear'>
						<!-- 활성화 active : class 추가 -->
						<li value="R" <c:if test="${c.productOrderBy eq 'R'}">class="active"</c:if>><a href="javascript:;">최근순</a></li>
						<li value="P" <c:if test="${c.productOrderBy eq 'P'}">class="active"</c:if>><a href="javascript:;">공감순</a></li>
					</ul>
					<a href="javascript:" class='btn_sympathy <c:if test="${c.likeYn eq 'Y'}">active</c:if>'>나의공감</a>
				</div>
			</div>
		</div>
		<div class="life_inner">
			<div class="life_zone">			
				<c:if test="${not empty lifeList}">
					<c:forEach items="${lifeList}" var="l" varStatus="st1">							
						<c:choose>
						  	<c:when test='${not empty l.lifeMainParam.imgUrl}'>
								<c:if test='${fn:length(l.lifeSubParam) > 1}'><c:set var="mainClass" value="set03"></c:set></c:if>
								<c:if test='${fn:length(l.lifeSubParam) < 2}'><c:set var="mainClass" value="set01"></c:set></c:if>
							</c:when>
							<c:otherwise>
								<c:if test='${fn:length(l.lifeSubParam) > 1}'><c:set var="mainClass" value="set02"></c:set></c:if>
								<c:if test='${fn:length(l.lifeSubParam) < 2}'><c:set var="mainClass" value="set04"></c:set></c:if>
							</c:otherwise>
						</c:choose>
						<c:choose>
							<c:when test='${not empty l.lifeMainParam.imgUrl}'>
								<c:if test='${fn:length(l.lifeSubParam) < 2}'>
									<c:set var="subClass" value="one"></c:set>
								</c:if>
							</c:when>
							<c:otherwise>
								<c:set var="subClass" value=""></c:set>
							</c:otherwise>
						</c:choose>										
						<div class="${mainClass}">
							<div class="sum_life">
								<c:if test="${not empty l.lifeMainParam.imgUrl}">
									<div class="img_life">
										<ui:image src="${l.lifeMainParam.imgUrl}" alt="${l.lifeMainParam.imgAlt}" />
									</div>
								</c:if>									
								<div class="txt_life">
									<h2>${l.lifeMainParam.mainText}</h2>
									<p>${l.lifeMainParam.subText}</p>
									<div class="like_heart clear">									
										<c:set var="wishCnt" value="${l.lifeMainParam.wishCnt}"/>
										<c:if test="${l.lifeMainParam.wishCnt > 999}"><c:set var="wishCnt" value="999+"/></c:if>																		
										<span class="heart <c:if test="${l.lifeMainParam.userWishYn eq 'Y'}"> on</c:if>" code="${l.lifeMainParam.svcSeq}">${wishCnt}</span><!-- 활성화시 on : class 추가 -->
										<a href="javascript:" onclick="addBizWishLife(this);return false;" class='btn_life' svcSeq="${l.lifeMainParam.svcSeq}"></a>
									</div>
								</div>								
								<c:choose>
									<c:when test="${fn:length(l.lifeSubParam) > 1}">
										<div class="life_slider">
											<ul class='clear'>
												<c:forEach items="${l.lifeSubParam}" var="m" varStatus="st2">
													<li>
														<a href="/ht/product/detail?barcode=${m.sellPrdtBcode}">
															<ui:image src="${m.imgUrl}" />
															<div class="desc_life">
																<h2>${m.title}</h2>
<%-- 																<h3>${m.prvdTitle}</h3> --%>
																<p>${m.prdtName}</p>
															</div>
														</a>
													</li>													
													<c:if test="${fn:length(l.lifeSubParam) > 2 && st2.last}">
														<li>
														</li>
													</c:if>																																							
												</c:forEach>
											</ul>
<!-- 											<div class="custom-pager"><strong></strong><span></span></div> -->
										</div>																			
									</c:when>
									<c:otherwise>
										<c:forEach items="${l.lifeSubParam}" var="n" varStatus="st3">											
											<div class="side_wrap ${subClass}">
												<a href="/ht/product/detail?barcode=${n.sellPrdtBcode}">
													<ui:image src="${n.imgUrl}" />
													<h2>${n.title}</h2>
<%-- 												<h3>${m.prvdTitle}</h3> --%>
													<p>${m.prdtName}</p>
												</a>	
											</div>
										</c:forEach>
									</c:otherwise>
								</c:choose>
							</div>
						</div>										
					</c:forEach>				
				</c:if>			
			</div>
		</div>
	</div>
</body>
</html>