<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="RecordStockSQL">
    <typeAlias alias="recordStock" type="kr.co.hottracks.site.model.common.record.RecordStock"/>
    
    <!-- 
        음반 재고변화 등록
     -->
    <insert id="insertRecordStock" parameterClass="recordStock">
        <selectKey keyProperty="recProdStockSeq" resultClass="int">SELECT REC_PROD_STOCK_SEQ.NEXTVAL FROM DUAL</selectKey>
        
        INSERT INTO TB_REC_PROD_STOCK (REC_PROD_STOCK_SEQ, STOCK_CNT_CENTER, STOCK_CNT_SHOP, REGST_DTM, REASON, SELL_PRDT_BCODE, STOCK_CNT_ACCOUNT)
                               VALUES (#recProdStockSeq#, #stockCntCenter#, #stockCntShop#, sysdate, #reason#, #sellPrdtBcode#, #stockCntAccount#)
    </insert>
   
    <!-- 
        음반 최종 재고변화 반환
   -->
    <select id="selectRecordStock"  parameterClass="string" resultClass="recordStock">
        /* RecordStockSQL.selectRecordStock */
        SELECT B.REC_PROD_STOCK_SEQ     recProdStockSeq
             , B.SELL_PRDT_BCODE        sellPrdtBcode
             , B.STOCK_CNT_CENTER       stockCntCenter
             , B.STOCK_CNT_SHOP         stockCntShop
             , B.STOCK_CNT_ACCOUNT      stockCntAccount
          FROM TB_SELL_PRODUCT A
          JOIN V_REC_PROD_STOCK B ON A.SELL_PRDT_BCODE = B.SELL_PRDT_BCODE
         WHERE A.SELL_PRDT_BCODE = #sellPrdtBcode#
    </select>
</sqlMap>
