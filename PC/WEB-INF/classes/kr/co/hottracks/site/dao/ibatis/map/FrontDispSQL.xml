<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="FrontDispSQL">
    <typeAlias alias="dispCriteria" type="kr.co.hottracks.site.model.common.disp.DispCriteria"/>
    <typeAlias alias="dispMaster" type="kr.co.hottracks.site.model.common.disp.DispMaster"/>
    <typeAlias alias="dispBnrExt" type="kr.co.hottracks.site.model.common.disp.DispBnrExt"/>
    <typeAlias alias="dispPrdtExt" type="kr.co.hottracks.site.model.common.disp.DispPrdtExt"/>
    <typeAlias alias="dispBrandExt" type="kr.co.hottracks.site.model.common.disp.DispBrandExt"/>
    <typeAlias alias="dispBnrStoreExt" type="kr.co.hottracks.site.model.common.disp.DispBnrStoreExt"/>
    <typeAlias alias="dispRecobellCriteria" type="kr.co.hottracks.site.model.common.disp.DispRecobellCriteria"/>
    
    <!--  
        작성자: 장진용
        작성일 : 2014.06.19
        기능 : 배너 마스터 목록 반환
    -->
    <select id="getBnrMaster" parameterClass="string" resultClass="string">
        /* FrontDispSQL.getBnrMaster */
        SELECT B.LNK_URL
          FROM TM_BNR B
         WHERE B.BNR_SEQ = #bnrSeq#
    </select>
    
    <!--  
        작성자: 장진용
        작성일 : 2014.06.20
        기능 : 전시 마스터 정보 반환
    -->
    <select id="getDispMaster" parameterClass="dispCriteria" resultClass="dispMaster">
        /* FrontDispSQL.getDispMaster */
        SELECT DISP_MSTR_ID     dispMstrId
             , TITLE            title
             , IMG_URL          imgUrl
             , IMG_URL2         imgUrl2
             , IMG_ALT          imgAlt
             , MOD_DTM          modDtm
             , CTGR_ID          ctgrId
          FROM TM_DISP
         WHERE DISP_MSTR_ID LIKE #dispMstrId# || '%'
         <isNotEmpty property="ctgrId">
            AND CTGR_ID LIKE #ctgrId# || '%'
         </isNotEmpty>
         ORDER BY DISP_MSTR_ID
    </select>
    
    <!--  
        작성자: 장진용
        작성일 : 2014.06.20
        기능 : 전시 배너 목록 반환
    -->
    <select id="getDispBnr" parameterClass="dispCriteria" resultClass="dispBnrExt">
        /* FrontDispSQL.getDispBnr */
        SELECT A.DISP_SEQ           dispSeq
             , A.DISP_MSTR_ID       dispMstrId
             , A.MALL_ID            mallId
             , A.CTGR_ID            ctgrId
             , A.GROUP_NUM          groupNum
             , A.DISP_ORDER         dispOrder
             , A.BNR_SEQ            bnrSeq
             , A.BNR_WIDTH          bnrWidth
             , A.BNR_HEIGHT         bnrHeight
             , A.DISP_YN            dispYn
             , B.IMG_URL            bnrImgUrl
             , B.IMG_URL2           bnrImgUrl2
             , B.LNK_URL            bnrLnkUrl
             , B.IMG_MAP            bnrImgMap
             , B.NEW_WIN_YN         bnrNewWinYn
             , B.TITLE              bnrTitle
             , B.SUB_TITLE          bnrSubTitle
             , B.IMG_WIDTH          orgBnrWidth
             , B.IMG_HEIGHT         orgBnrHeight
             , B.FLAG_CD			flagCd
             , B.DISC_RATE   		discRate
          FROM TD_DISP_BNR A
          JOIN TM_BNR B ON A.BNR_SEQ = B.BNR_SEQ
         WHERE A.DISP_YN = 'Y'
           AND A.DISP_MSTR_ID LIKE #dispMstrId# || '%'
           AND A.MALL_ID IN ('00', #mallId#) 
           <isNotEmpty property="ctgrId" prepend="AND">
               A.CTGR_ID LIKE #ctgrId# || '%'
           </isNotEmpty>
           AND (B.DISP_START_DT||B.DISP_START_CLOCK &lt;= TO_CHAR(SYSDATE,'YYYYMMDDHH24') OR B.DISP_START_DT = '19000101')
           AND (B.DISP_END_DT||B.DISP_END_CLOCK &gt;= TO_CHAR(SYSDATE,'YYYYMMDDHH24') OR B.DISP_END_DT = '99991231')
         ORDER BY A.DISP_MSTR_ID, A.GROUP_NUM, A.DISP_ORDER
    </select>
    
    <!--  
        작성자: 장진용
        작성일 : 2014.09.03
        기능 : 전시 배너 목록 반환 - Fix
    -->
    <select id="getDispBnrFix" parameterClass="dispCriteria" resultClass="dispBnrExt">
        /* FrontDispSQL.getDispBnrFix */
        SELECT A.DISP_SEQ           dispSeq
             , A.DISP_MSTR_ID       dispMstrId
             , A.MALL_ID            mallId
             , A.CTGR_ID            ctgrId
             , A.GROUP_NUM          groupNum
             , A.DISP_ORDER         dispOrder
             , A.BNR_SEQ            bnrSeq
             , A.BNR_WIDTH          bnrWidth
             , A.BNR_HEIGHT         bnrHeight
             , A.DISP_YN            dispYn
             , B.IMG_URL            bnrImgUrl
             , B.IMG_URL2           bnrImgUrl2
             , B.LNK_URL            bnrLnkUrl
             , B.IMG_MAP            bnrImgMap
             , B.NEW_WIN_YN         bnrNewWinYn
             , B.TITLE              bnrTitle
             , B.SUB_TITLE          bnrSubTitle
             , B.IMG_ALT            bnrImgAlt
          FROM TD_DISP_BNR A
          JOIN TM_BNR B ON A.BNR_SEQ = B.BNR_SEQ
         WHERE A.DISP_YN = 'Y'
           AND A.DISP_MSTR_ID = #dispMstrId#
           AND A.MALL_ID = '02'
           AND (B.DISP_START_DT||B.DISP_START_CLOCK &lt;= TO_CHAR(SYSDATE,'YYYYMMDDHH24') OR B.DISP_START_DT = '19000101')
           AND (B.DISP_END_DT||B.DISP_END_CLOCK &gt;= TO_CHAR(SYSDATE,'YYYYMMDDHH24') OR B.DISP_END_DT = '99991231')
           <isNotEmpty property="ctgrId" prepend="AND">
               A.CTGR_ID = #ctgrId#
           </isNotEmpty>
         ORDER BY A.DISP_MSTR_ID, A.GROUP_NUM, A.DISP_ORDER
    </select>
    
    <!--  
        작성자: 장진용
        작성일 : 2014.06.20
        기능 : 전시 상품 목록 반환
    -->
    <select id="getDispPrdt" parameterClass="dispCriteria" resultClass="dispPrdtExt">
        /* FrontDispSQL.getDispPrdt */
        SELECT A.DISP_SEQ           dispSeq
             , A.DISP_MSTR_ID       dispMstrId
             , A.MALL_ID            mallId
             , A.CTGR_ID            ctgrId
             , A.GROUP_NUM          groupNum
             , A.DISP_ORDER         dispOrder
             , A.SELL_PRDT_BCODE    sellPrdtBcode
             , NVL(A.PRDT_NAME, B.PRDT_NAME)    prdtName
             , NVL(A.PRDT_DESC, B.PRVD_TITLE)   prdtDesc
             , A.DISP_YN            dispYn
             , A.REGST_DTM          regstDtm
             , A.REGST_ADMIN_ID     regstAdminId
             , B.PRDT_NAME          basePrdtName
             , B.PRVD_TITLE         basePrdtDesc
             , B.PRDT_SELL_PRICE    basePrdtSellPrice
             , B.RCRD_CD            rcrdCd
             , B.SELL_PRDT_GBN      sellPrdtGbn
             , B.NYO_SELL_BAN_YN    nyoSellBanYn
             , B.PRDT_STAT_CODE     prdtStatCode
             , C.ARTI_NAME          artiName
             , FC_GET_PRODUCT_IMAGE_URL(A.SELL_PRDT_BCODE)      prdtImgUrl
             , FC_GET_PRODUCT_IMAGE_URL2(A.SELL_PRDT_BCODE)     productImageUrl2
             , FC_GET_DC_PRICE(A.SELL_PRDT_BCODE, A.MALL_ID)    lastDcPrice
             , FC_GET_CPN_PRICE(A.SELL_PRDT_BCODE, A.MALL_ID)   lastCpnPrice
             , D.BRAND_ID           brandId
             , D.BRAND_NAME         brandName
             , NVL(D.BRAND_ENG_NAME, D.BRAND_NAME)              brandEngName
             , FC_GET_WISH_PRODUCT_COUNT(B.SELL_PRDT_BCODE, '02')   wishPrdtCnt
             , FC_GET_PRODUCT_ICON_CODE(B.SELL_PRDT_BCODE, '02')    prdtIcon
             , FC_GET_REVIEW_PRODUCT_COUNT(A.SELL_PRDT_BCODE, '02') reviewCount
          FROM TD_DISP_PRDT A
          JOIN TB_SELL_PRODUCT B ON A.SELL_PRDT_BCODE = B.SELL_PRDT_BCODE AND B.PRMT_CODE = 'C0302' AND B.PRDT_STAT_CODE IN ('C0312', 'C0313')
          LEFT JOIN TB_RECORD C ON B.SELL_PRDT_BCODE = C.SELL_PRDT_BCODE
          LEFT JOIN TB_BRAND D ON B.BRAND_ID = D.BRAND_ID
         WHERE A.DISP_YN = 'Y'
           AND DISP_MSTR_ID LIKE #dispMstrId# || '%'
           AND A.MALL_ID = #mallId#
           <isNotEmpty property="ctgrId" prepend="AND">
               A.CTGR_ID LIKE #ctgrId# || '%'
           </isNotEmpty>
           <isNotEmpty property="exceptDispMstrId" prepend="AND">
               DISP_MSTR_ID NOT IN ($exceptDispMstrId$)
           </isNotEmpty>
         ORDER BY A.DISP_MSTR_ID, A.DISP_ORDER, B.PRMT_DTM DESC
    </select>
    
    <!--  
        작성자: 장진용
        작성일 : 2014.09.02
        기능 : 전시 상품 목록 반환 - Fix
    -->
    <select id="getDispPrdtFix" parameterClass="dispCriteria" resultClass="dispPrdtExt">
        /* FrontDispSQL.getDispPrdtFix */
        SELECT A.DISP_SEQ           dispSeq
             , A.DISP_MSTR_ID       dispMstrId
             , A.MALL_ID            mallId
             , A.CTGR_ID            ctgrId
             , A.GROUP_NUM          groupNum
             , A.DISP_ORDER         dispOrder
             , A.SELL_PRDT_BCODE    sellPrdtBcode
             , NVL(A.PRDT_NAME, B.PRDT_NAME)    prdtName
             , NVL(A.PRDT_DESC, B.PRVD_TITLE)   prdtDesc
             , A.DISP_YN            dispYn
             , A.REGST_DTM          regstDtm
             , A.REGST_ADMIN_ID     regstAdminId
             , B.PRDT_NAME          basePrdtName
             , B.PRVD_TITLE         basePrdtDesc
             , B.PRDT_SELL_PRICE    basePrdtSellPrice
             , B.RCRD_CD            rcrdCd
             , B.SELL_PRDT_GBN      sellPrdtGbn
             , B.NYO_SELL_BAN_YN    nyoSellBanYn
             , B.PRDT_STAT_CODE     prdtStatCode
             , C.ARTI_NAME          artiName
             , FC_GET_PRODUCT_IMAGE_URL(A.SELL_PRDT_BCODE)      prdtImgUrl
             , FC_GET_PRODUCT_IMAGE_URL2(A.SELL_PRDT_BCODE)     productImageUrl2
             , FC_GET_DC_PRICE(A.SELL_PRDT_BCODE, A.MALL_ID)    lastDcPrice
             , FC_GET_CPN_PRICE(A.SELL_PRDT_BCODE, A.MALL_ID)   lastCpnPrice
             , D.BRAND_ID           brandId
             , D.BRAND_NAME         brandName
             , NVL(D.BRAND_ENG_NAME, D.BRAND_NAME)              brandEngName
             , FC_GET_WISH_PRODUCT_COUNT(B.SELL_PRDT_BCODE, '02')   wishPrdtCnt
             , FC_GET_PRODUCT_ICON_CODE(B.SELL_PRDT_BCODE, '02')    prdtIcon
             , FC_GET_REVIEW_PRODUCT_COUNT(A.SELL_PRDT_BCODE, '02') reviewCount
          FROM TD_DISP_PRDT A
          JOIN TB_SELL_PRODUCT B ON A.SELL_PRDT_BCODE = B.SELL_PRDT_BCODE AND B.PRMT_CODE = 'C0302' AND B.PRDT_STAT_CODE IN ('C0312', 'C0313')
          LEFT JOIN TB_RECORD C ON B.SELL_PRDT_BCODE = C.SELL_PRDT_BCODE
          LEFT JOIN TB_BRAND D ON B.BRAND_ID = D.BRAND_ID
         WHERE A.DISP_YN = 'Y'
           AND DISP_MSTR_ID = #dispMstrId#
           AND A.MALL_ID = #mallId#
           <isNotEmpty property="ctgrId" prepend="AND">
               A.CTGR_ID = #ctgrId#
           </isNotEmpty>
         ORDER BY A.DISP_MSTR_ID, A.DISP_ORDER, B.PRMT_DTM DESC
    </select>
    
    
    <!--  
        작성자: 장진용
        작성일 : 2014.09.02
        기능 : 전시 상품 목록 반환 - Fix
    -->
    <select id="countDispPrdtFix" parameterClass="dispCriteria" resultClass="int">
        /* FrontDispSQL.countDispPrdtFix */
        SELECT COUNT(*) AS CNT
          FROM TD_DISP_PRDT A
          JOIN TB_SELL_PRODUCT B ON A.SELL_PRDT_BCODE = B.SELL_PRDT_BCODE
         WHERE A.DISP_YN = 'Y'
           AND DISP_MSTR_ID = #dispMstrId#
           AND A.MALL_ID = #mallId#
           <isNotEmpty property="ctgrId" prepend="AND">
               A.CTGR_ID = #ctgrId#
           </isNotEmpty>
           AND ROWNUM &lt; #topCount# + 1
    </select>
    
    <!--  
        작성자: 장진용
        작성일 : 2014.09.02
        기능 : 전시 상품 목록 반환 - 랭킹용
    -->
    <select id="getDispPrdt4Rank" parameterClass="dispCriteria" resultClass="dispPrdtExt">
        /* FrontDispSQL.getDispPrdt4Rank */
        SELECT A.DISP_SEQ           dispSeq
             , A.DISP_MSTR_ID       dispMstrId
             , A.MALL_ID            mallId
             , A.CTGR_ID            ctgrId
             , A.GROUP_NUM          groupNum
             , A.DISP_ORDER         dispOrder
             , A.SELL_PRDT_BCODE    sellPrdtBcode
             , NVL(A.PRDT_NAME, B.PRDT_NAME)    prdtName
             , NVL(A.PRDT_DESC, B.PRVD_TITLE)   prdtDesc
             , A.DISP_YN            dispYn
             , A.REGST_DTM          regstDtm
             , A.REGST_ADMIN_ID     regstAdminId
             , B.PRDT_NAME          basePrdtName
             , B.PRVD_TITLE         basePrdtDesc
             , B.PRDT_SELL_PRICE    basePrdtSellPrice
             , B.RCRD_CD            rcrdCd
             , B.SELL_PRDT_GBN      sellPrdtGbn
             , B.NYO_SELL_BAN_YN    nyoSellBanYn
             , B.PRDT_STAT_CODE     prdtStatCode
             , C.ARTI_NAME          artiName
             , FC_GET_PRODUCT_IMAGE_URL(A.SELL_PRDT_BCODE)      prdtImgUrl
             , FC_GET_PRODUCT_IMAGE_URL2(A.SELL_PRDT_BCODE)     productImageUrl2
             , FC_GET_DC_PRICE(A.SELL_PRDT_BCODE, A.MALL_ID)    lastDcPrice
             , FC_GET_CPN_PRICE(A.SELL_PRDT_BCODE, A.MALL_ID)   lastCpnPrice
             , D.BRAND_ID           brandId
             , D.BRAND_NAME         brandName
             , NVL(D.BRAND_ENG_NAME, D.BRAND_NAME)              brandEngName
             , FC_GET_WISH_PRODUCT_COUNT(B.SELL_PRDT_BCODE, '02')   wishPrdtCnt
             , FC_GET_PRODUCT_ICON_CODE(B.SELL_PRDT_BCODE, '02')    prdtIcon
             , FC_GET_REVIEW_PRODUCT_COUNT(A.SELL_PRDT_BCODE, '02') reviewCount
          FROM TD_DISP_PRDT A
          JOIN TB_SELL_PRODUCT B ON A.SELL_PRDT_BCODE = B.SELL_PRDT_BCODE AND B.PRMT_CODE = 'C0302' AND B.PRDT_STAT_CODE IN ('C0312', 'C0313')
          LEFT JOIN TB_RECORD C ON B.SELL_PRDT_BCODE = C.SELL_PRDT_BCODE
          LEFT JOIN TB_BRAND D ON B.BRAND_ID = D.BRAND_ID
         WHERE A.DISP_YN = 'Y'
           AND DISP_MSTR_ID = #dispMstrId#
           AND A.MALL_ID = #mallId#
           <isNotEmpty property="ctgrId" prepend="AND">
               A.CTGR_ID = #ctgrId#
           </isNotEmpty>
         ORDER BY A.DISP_MSTR_ID, A.DISP_ORDER, B.PRMT_DTM DESC
    </select>
    
    <!--  
        작성자: 장진용
        작성일 : 2014.09.02
        기능 : 전시 상품 목록 수 반환 - 랭킹용
    -->
    <select id="countDispPrdt4Rank" parameterClass="dispCriteria" resultClass="int">
        /* FrontDispSQL.countDispPrdt4Rank */
        SELECT COUNT(*)
          FROM TD_DISP_PRDT A
          JOIN TB_SELL_PRODUCT B ON A.SELL_PRDT_BCODE = B.SELL_PRDT_BCODE AND B.PRMT_CODE = 'C0302' AND B.PRDT_STAT_CODE IN ('C0312', 'C0313')
          LEFT JOIN TB_RECORD C ON B.SELL_PRDT_BCODE = C.SELL_PRDT_BCODE
          LEFT JOIN TB_BRAND D ON B.BRAND_ID = D.BRAND_ID
         WHERE A.DISP_YN = 'Y'
           AND DISP_MSTR_ID = #dispMstrId#
           AND A.MALL_ID = #mallId#
           AND rownum <![CDATA[ < ]]> #topCount# + 1
           <isNotEmpty property="ctgrId" prepend="AND">
               A.CTGR_ID = #ctgrId#
           </isNotEmpty>
    </select>
    
    <!--  
        작성자: 장진용
        작성일 : 2014.06.20
        기능 : 전시 브랜드 목록 반환
    -->
    <select id="getDispBrand" parameterClass="dispCriteria" resultClass="dispBrandExt">
        /* FrontDispSQL.getDispBrand */
        SELECT A.DISP_SEQ           dispSeq
             , A.DISP_MSTR_ID       dispMstrId
             , A.MALL_ID            mallId
             , A.CTGR_ID            ctgrId
             , A.GROUP_NUM          groupNum
             , A.DISP_ORDER         dispOrder
             , A.BRAND_ID           brandId
             , NVL(A.BRAND_NAME, B.BRAND_NAME)          brandName
             , NVL(A.BRAND_ENG_NAME, B.BRAND_ENG_NAME)  brandEngName
             , A.DISP_YN            dispYn
             , A.REGST_DTM          regstDtm
             , A.REGST_ADMIN_ID     regstAdminId
             , B.BRAND_NAME         baseBrandName
             , B.BRAND_ENG_NAME     baseBrandEngName
          FROM TD_DISP_BRAND A
          JOIN TB_BRAND B ON A.BRAND_ID = B.BRAND_ID AND B.BRAND_DISP_YN = 'Y'
         WHERE A.DISP_YN = 'Y'
           AND A.DISP_MSTR_ID LIKE #dispMstrId# || '%'
           AND A.MALL_ID = #mallId#
           <isNotEmpty property="ctgrId" prepend="AND">
               A.CTGR_ID LIKE #ctgrId# || '%'
           </isNotEmpty>
         ORDER BY A.DISP_MSTR_ID, A.DISP_ORDER, B.BRAND_ID DESC
    </select>
    
    <!--  
        작성자: 장진용
        작성일 : 2014.09.02
        기능 : 전시 브랜드 목록 반환 - 이미지포함
    -->
    <select id="getDispBrandWithImage" parameterClass="dispCriteria" resultClass="dispBrandExt">
        /* FrontDispSQL.getDispBrandWithImage */
        SELECT A.DISP_SEQ           dispSeq
             , A.DISP_MSTR_ID       dispMstrId
             , A.MALL_ID            mallId
             , A.CTGR_ID            ctgrId
             , A.GROUP_NUM          groupNum
             , A.DISP_ORDER         dispOrder
             , A.BRAND_ID           brandId
             , NVL(A.BRAND_NAME, B.BRAND_NAME)          brandName
             , NVL(A.BRAND_ENG_NAME, B.BRAND_ENG_NAME)  brandEngName
             , A.DISP_YN            dispYn
             , A.REGST_DTM          regstDtm
             , A.REGST_ADMIN_ID     regstAdminId
             , B.BRAND_NAME         baseBrandName
             , B.BRAND_ENG_NAME     baseBrandEngName
             , B.BRAND_SMRY         baseBrandSmry
             , (SELECT SA.BRAND_IMAGE_URL FROM TB_BRAND_IMAGE SA WHERE SA.BRAND_ID = A.BRAND_ID AND SA.BRAND_IMAGE_CODE = 'C0291')    brandImageC0291
             , (SELECT SA.BRAND_IMAGE_URL FROM TB_BRAND_IMAGE SA WHERE SA.BRAND_ID = A.BRAND_ID AND SA.BRAND_IMAGE_CODE = 'C0292')    brandImageC0292
             , (SELECT SA.BRAND_IMAGE_URL FROM TB_BRAND_IMAGE SA WHERE SA.BRAND_ID = A.BRAND_ID AND SA.BRAND_IMAGE_CODE = 'C0293')    brandImageC0293
             , (SELECT SA.BRAND_IMAGE_URL FROM TB_BRAND_IMAGE SA WHERE SA.BRAND_ID = A.BRAND_ID AND SA.BRAND_IMAGE_CODE = 'C0294')    brandImageC0294
             , (SELECT SA.BRAND_IMAGE_URL FROM TB_BRAND_IMAGE SA WHERE SA.BRAND_ID = A.BRAND_ID AND SA.BRAND_IMAGE_CODE = 'C0295')    brandImageC0295
             , (SELECT SA.BRAND_IMAGE_URL FROM TB_BRAND_IMAGE SA WHERE SA.BRAND_ID = A.BRAND_ID AND SA.BRAND_IMAGE_CODE = 'C0296')    brandImageC0296
             , (SELECT SA.BRAND_IMAGE_URL FROM TB_BRAND_IMAGE SA WHERE SA.BRAND_ID = A.BRAND_ID AND SA.BRAND_IMAGE_CODE = 'C0297')    brandImageC0297
             , (SELECT SA.BRAND_IMAGE_URL FROM TB_BRAND_IMAGE SA WHERE SA.BRAND_ID = A.BRAND_ID AND SA.BRAND_IMAGE_CODE = 'C0298')    brandImageC0298
             , (SELECT SA.BRAND_IMAGE_URL FROM TB_BRAND_IMAGE SA WHERE SA.BRAND_ID = A.BRAND_ID AND SA.BRAND_IMAGE_CODE = 'C0299')    brandImageC0299
             , (SELECT SA.BRAND_IMAGE_URL FROM TB_BRAND_IMAGE SA WHERE SA.BRAND_ID = A.BRAND_ID AND SA.BRAND_IMAGE_CODE = 'C029A')    brandImageC029A
             , (SELECT SA.BRAND_IMAGE_URL FROM TB_BRAND_IMAGE SA WHERE SA.BRAND_ID = A.BRAND_ID AND SA.BRAND_IMAGE_CODE = 'C029B')    brandImageC029B
             , (SELECT SA.BRAND_IMAGE_URL FROM TB_BRAND_IMAGE SA WHERE SA.BRAND_ID = A.BRAND_ID AND SA.BRAND_IMAGE_CODE = 'C029C')    brandImageC029C
          FROM TD_DISP_BRAND A
          JOIN TB_BRAND B ON A.BRAND_ID = B.BRAND_ID AND B.BRAND_DISP_YN = 'Y'
         WHERE A.DISP_YN = 'Y'
           AND DISP_MSTR_ID = #dispMstrId#
           AND A.MALL_ID = #mallId#
           <isNotEmpty property="ctgrId" prepend="AND">
               A.CTGR_ID = #ctgrId#
           </isNotEmpty>
         ORDER BY A.DISP_MSTR_ID, A.DISP_ORDER, B.BRAND_ID DESC
    </select>
    
    
    <!--  
        작성자: 권동희
        작성일 : 2017.04.13
        기능 : 영업점소개 이미지
    -->
    <select id="getBnrStoreList" parameterClass="dispCriteria" resultClass="dispBnrStoreExt">
        /* FrontDispSQL.getBnrStoreList */
        SELECT DISP_ORDER              dispOrder
             , BS.BNR_SEQ              bnrSeq
             , BNR_WIDTH               bnrWidth
             , BNR_HEIGHT              bnrHeight
             , DISP_YN                 dispYn
             , IMG_URL                 imgUrl
             , IMG_ALT                 imgAlt
             , DISP_START_DT           dispStartDt
             , DISP_END_DT             dispEndDt
          FROM TD_DISP_BNR_STORE DBS
          JOIN TM_BNR_STORE BS ON DBS.BNR_SEQ = BS.BNR_SEQ
         WHERE DISP_MSTR_ID = #dispMstrId#
           AND MALL_ID = #mallId#
           AND DEPT_CODE = #deptCode#
           AND DISP_YN = 'Y'
           AND IMG_URL IS NOT NULL
          ORDER BY DISP_ORDER ASC
    </select>
    
    
    <!-- 
    기능 : 다이어리 페이지 필요한 것만 압축
    생성일 : 2017-09-03
     -->
    <select id="getDispPrdtSimple" parameterClass="dispCriteria" resultClass="dispPrdtExt">
        /* FrontDispSQL.getDispPrdtSimple */
        SELECT A.DISP_SEQ                                       dispSeq
             , A.DISP_ORDER                                     dispOrder
             , A.SELL_PRDT_BCODE                                sellPrdtBcode
             , NVL(A.PRDT_NAME, B.PRDT_NAME)                    prdtName
             , B.PRDT_SELL_PRICE                                basePrdtSellPrice
             , B.PRDT_STAT_CODE                                 prdtStatCode
             , FC_GET_PRODUCT_IMAGE_URL(A.SELL_PRDT_BCODE)      productImageUrl
             , FC_GET_PRODUCT_IMAGE_URL2(A.SELL_PRDT_BCODE)     productImageUrl2
             , FC_GET_DC_PRICE(A.SELL_PRDT_BCODE, A.MALL_ID)    lastDcPrice
             , FC_GET_CPN_PRICE(A.SELL_PRDT_BCODE, A.MALL_ID)   lastCpnPrice
             , NVL(D.BRAND_ENG_NAME, D.BRAND_NAME)              brandEngName
             , (SELECT TITLE FROM TM_DISP WHERE DISP_MSTR_ID =#dispMstrId# AND CTGR_ID =#ctgrId#  AND ROWNUM &lt; 2)    title
             , FC_GET_PRODUCT_ICON_CODE(A.SELL_PRDT_BCODE, #mallId#)                                                   prdtIcon
             , FC_GET_WISH_PRODUCT_COUNT(A.SELL_PRDT_BCODE, '02')                                                      wishPrdtCnt
             , FC_GET_REVIEW_PRODUCT_COUNT(A.SELL_PRDT_BCODE, '02')                                                    reviewCount
          FROM TD_DISP_PRDT A
          JOIN TB_DISPLAY_PRODUCT B ON A.SELL_PRDT_BCODE = B.SELL_PRDT_BCODE 
          LEFT JOIN TB_RECORD C ON B.SELL_PRDT_BCODE = C.SELL_PRDT_BCODE
          LEFT JOIN TB_BRAND D ON B.BRAND_ID = D.BRAND_ID
         WHERE A.DISP_YN = 'Y'
           AND DISP_MSTR_ID =#dispMstrId#
           AND A.MALL_ID =#mallId#
           <isNotEmpty property="ctgrId" prepend="AND">
               A.CTGR_ID = #ctgrId#
           </isNotEmpty>
         ORDER BY A.DISP_MSTR_ID, A.DISP_ORDER, B.PRMT_DTM DESC 
    </select>
    
    <select id="getRecobellPrdtFix" parameterClass="dispRecobellCriteria" resultClass="dispPrdtExt">
    	/* FrontDispSQL.getRecobellPrdtFix */
         select 
         	A.SELL_PRDT_BCODE    sellPrdtBcode
			, A.SELL_PRDT_GBN      sellPrdtGbn
			, FC_GET_PRODUCT_IMAGE_URL(A.SELL_PRDT_BCODE) prdtImgUrl
			, NVL(A.PRDT_NAME, FC_GET_PRDT_NAME(A.SELL_PRDT_BCODE , '02'))  prdtName
			, A.RCRD_CD   rcrdCd
			, FC_GET_CPN_PRICE(A.SELL_PRDT_BCODE, '02')   lastCpnPrice
			, A.PRDT_SELL_PRICE    prdtSellPrice
			, FC_GET_PRODUCT_IMAGE_URL(A.SELL_PRDT_BCODE)      productImageUrl
			, FC_GET_PRODUCT_IMAGE_URL2(A.SELL_PRDT_BCODE)     productImageUrl2
			, A.NYO_SELL_BAN_YN    nyoSellBanYn
			, FC_GET_REVIEW_PRODUCT_COUNT(A.SELL_PRDT_BCODE, '02') reviewCount
			, FC_GET_WISH_PRODUCT_COUNT(A.SELL_PRDT_BCODE, '02')   wishPrdtCnt
			, FC_GET_PRODUCT_ICON_CODE(A.SELL_PRDT_BCODE, '02')    prdtIcon
			, A.PRDT_SELL_PRICE    basePrdtSellPrice
			, FC_GET_CPN_PRICE(A.SELL_PRDT_BCODE, '02')   lastCpnPrice
			, A.PRDT_STAT_CODE     prdtStatCode
			, C.BRAND_ID brandId
			, NVL(C.BRAND_ENG_NAME, C.BRAND_NAME)                   brandName
			, FC_GET_DC_RATE_MALL(A.SELL_PRDT_BCODE, '02')         	lastDcRate
          from TB_SELL_PRODUCT A
          join (
                select rownum RK, AA 
                  from (
			           <iterate property="sellPrdtBcode" conjunction="union all">
			                select #sellPrdtBcode[]# AA from dual
			           </iterate>
                       )
               ) B on A.SELL_PRDT_BCODE = B.AA
      	  join TB_BRAND C on A.BRAND_ID = C.BRAND_ID
      	  left join TB_REC_PROD_STOCK_LAST D ON A.SELL_PRDT_BCODE = D.SELL_PRDT_BCODE
      	  where A.prdt_stat_code = 'C0312'
      	    and A.PRMT_CODE = 'C0302'
      	    and A.SELL_PRDT_BCODE NOT IN ('2310041561148','2300185984408')
      	    and FC_REC_GET_SALE_YN(D.STOCK_CNT_PRODUCT, A.RCRD_STAT, A.RCRD_HARD_SALE_YN, A.RCRD_LSALE_START_DTH, A.RCRD_LSALE_END_DTH, A.LAVE_COUNT) = 'Y'
           	<isEqual property="sellPrdtGbn" compareValue="01">
               AND A.sell_prdt_gbn in ('P','G','S')
            </isEqual>
            <isEqual property="sellPrdtGbn" compareValue="02">
               AND A.sell_prdt_gbn in ('R','D')
            </isEqual>
         order by B.RK
    </select>
    
    <select id="getEventDiaryList" parameterClass="HashMap" resultClass="dispPrdtExt">
        /* FrontDispSQL.getEventDiaryList */
		SELECT * 
		  FROM (
			SELECT ROWNUM dispSeq, AAA.* 
  			  FROM (
	            SELECT A.SELL_PRDT_BCODE                                  	sellPrdtBcode
	                , A.PRDT_NAME                                           prdtName
	                , A.PRDT_SELL_PRICE                                     basePrdtSellPrice
	                , FC_GET_CPN_PRICE(A.SELL_PRDT_BCODE, '02')             lastCpnPrice
	                , FC_GET_PRODUCT_IMAGE_URL(A.SELL_PRDT_BCODE)      		prdtImgUrl
	                , NVL(C.BRAND_ENG_NAME, C.BRAND_NAME)                   brandEngName
	                , FC_GET_WISH_PRODUCT_COUNT(A.SELL_PRDT_BCODE, '02')    wishPrdtCnt
	                , FC_GET_REVIEW_PRODUCT_COUNT(A.SELL_PRDT_BCODE, '02')  reviewCount
	                , FC_GET_DC_RATE_MALL(A.SELL_PRDT_BCODE, '02')         	lastDcRate
	              FROM TB_DISPLAY_PRODUCT A
	              LEFT JOIN TB_PRODUCT_CATEGORY B ON A.SELL_PRDT_BCODE = B.SELL_PRDT_BCODE
	              LEFT JOIN TB_BRAND C ON A.BRAND_ID = C.BRAND_ID
	              LEFT JOIN TB_DISPLAY_PRODUCT_SALE DPS ON B.SELL_PRDT_BCODE = DPS.SELL_PRDT_BCODE AND DPS.MALL_ID = 02 
<!-- 	              LEFT JOIN ( -->
<!--                          SELECT DECODE(DD.SELL_PRDT_GBN, 'S', DD.PRIME_SELL_PRDT_BCODE, DD.SELL_PRDT_BCODE) 		SELL_PRDT_BCODE -->
<!--                          	, COUNT(DECODE(DD.SELL_PRDT_GBN, 'S', DD.PRIME_SELL_PRDT_BCODE, DD.SELL_PRDT_BCODE))  	CNT -->
<!--                            FROM TB_ORDER AA -->
<!--                            JOIN TB_ORDER_PRODUCT BB ON AA.ORDER_NUM = BB.ORDER_NUM -->
<!--                            JOIN TB_PRODUCT_CATEGORY CC ON BB.SELL_PRDT_BCODE = CC.SELL_PRDT_BCODE -->
<!--                            JOIN TB_SELL_PRODUCT DD ON BB.SELL_PRDT_BCODE = DD.SELL_PRDT_BCODE -->
<!--                           WHERE AA.ORDER_DTM > SYSDATE -7 -->
<!--                             AND AA.ORDER_STATUS_CODE != 'C0281' -->
<!--                             AND AA.MALL_ID = #mallId# -->
<!--                           GROUP BY DECODE(DD.SELL_PRDT_GBN, 'S', DD.PRIME_SELL_PRDT_BCODE, DD.SELL_PRDT_BCODE) -->
<!--                       	) D ON A.SELL_PRDT_BCODE = D.SELL_PRDT_BCODE -->
	             WHERE A.PRDT_STAT_CODE = 'C0312'
	               AND A.REGST_DTM > '20200731'
	               AND B.STD_CTGR_YN = 'Y'
	               AND A.SELL_PRDT_GBN IN ('P','G')
	               AND B.CTGR_ID IN
	           	<iterate property="ctgrNum" open="(" close=")" conjunction=",">
		            #ctgrNum[]#
		        </iterate>
		        <isEqual property="sortNum" compareValue="0">
<!-- 	               ORDER BY NVL(D.CNT,0) DESC -->
	               ORDER BY NVL(DPS.SALE_CNT, 0) DESC
	            </isEqual>
		        <isEqual property="sortNum" compareValue="1">
	               ORDER BY A.REGST_DTM DESC
	            </isEqual>
		        <isEqual property="sortNum" compareValue="2">
	               ORDER BY FC_GET_DC_RATE_MALL(A.SELL_PRDT_BCODE, '02') DESC
	            </isEqual>
		        <isEqual property="sortNum" compareValue="3">
	               ORDER BY FC_GET_REVIEW_PRODUCT_COUNT(A.SELL_PRDT_BCODE, '02') DESC
	            </isEqual>
            		) AAA 
	            WHERE ROWNUM &lt;= #endPage#
			) 
		WHERE dispSeq &gt; #startPage#	         
    </select>
    
    <select id="getEventDiaryListCount" parameterClass="HashMap" resultClass="Integer">
        /* FrontDispSQL.getEventDiaryListCount */
		SELECT COUNT(*)
		  FROM TB_DISPLAY_PRODUCT A
		  LEFT JOIN TB_PRODUCT_CATEGORY B ON A.SELL_PRDT_BCODE = B.SELL_PRDT_BCODE
		WHERE A.PRDT_STAT_CODE = 'C0312'
		  AND B.STD_CTGR_YN = 'Y'
		  AND A.SELL_PRDT_GBN IN ('P','G')
		  AND B.CTGR_ID IN
		<iterate property="ctgrNum" open="(" close=")" conjunction=",">
			#ctgrNum[]#
		</iterate>
    </select>
</sqlMap>
