<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="CultureSQL">
    <!--
        기능: 컬처존 이벤트 
    -->
    <select id="getEvents4Culture" resultClass="kr.co.hottracks.site.model.common.event.EventMasterExt">
        /* CultureSQL.getEvents4Culture */
        SELECT A.EVENT_ID           eventId
             , A.EVENT_TITLE        eventTitle
             , A.EVENT_START_DT     eventStartDt
             , A.EVENT_END_DT       eventEndDt
             , A.EVENT_RANGE_INFO   eventRangeInfo
             , (SELECT B.IMAGE_URL FROM TB_EVENT_IMAGE B WHERE A.EVENT_ID = B.EVENT_ID AND B.EVENT_IMAGE_CODE = 'C0382')    thumImageUrl
          FROM TB_EVENT_MASTER A
         WHERE A.CULT_ZONE_YN = 'Y'
           AND FC_IS_VALID_EVENT(A.EVENT_ID, '02') = 'Y'
         ORDER BY A.EVENT_START_DT DESC
    </select>
    
    <!-- 당첨자 발표 List -->
    <select id="listWinnerData" resultClass="kr.co.hottracks.site.model.common.event.EventMasterExt">
        /* CultureSQL.listWinnerData */
        SELECT EM.EVENT_ID  eventId
             , EW.TITLE     eventTitle
          FROM TB_EVENT_MASTER EM
          JOIN TB_EVENT_WIN EW ON EM.EVENT_ID = EW.EVENT_ID
         WHERE EM.EVENT_STAT_CODE = 'C0181'
           AND EM.PWNR_RLS_YN = 'Y'
           AND EW.DISP_YN = 'Y'
           AND EM.CULT_ZONE_YN = 'Y'
           AND EW.MALL_ID = '02'
         ORDER BY EW.REGST_DTM DESC
    </select>
</sqlMap>